{% extends 'boards/../base.html' %}
{% load hosts %}
{% load gravatar %}
{% block title %}{{ profile_data.first_name }} {{ profile_data.last_name }} ({{ profile_data.username }}){% endblock %}

{% block breadcrumb %}
    <li class="breadcrumb-item active">{{ profile_data.username }}</li>
{% endblock %}

{% block content %}
    <div class="row py-3">
        <div class="col-md-3 col-sm-10 col-12 mb-3" id="sticky-sidebar">
            {% if user.pk == profile_data.pk %}
                <div class="mb-md-2 mb-4">
                    <a class="btn btn-primary" href="{% host_url 'edit_profile' host 'account' %}">Edit Profile</a>
                </div>
            {% endif %}
            <div class="sticky-top">
                <div class="nav flex-column">
                    <div class="row mt-md-3">
                        <div class="col-md-12 col-2 mb-4 order-md-0 order-1">
                            <p class="h4">{{ profile_data.username }}</p>
                        </div>
                        <div class="col-md-12 col-4 order-md-1 order-0">
                            <img src="{{ profile_data|gravatar }}" alt="{{ profile_data.username }}" class="w-100 rounded">
                        </div>
                        <div class="col-md-12 col-12 order-md-2 order-2">
                            <p class="text-dark">{{ profile_data.first_name }} {{ profile_data.last_name }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-9 col-sm-10 col-12 mb-3" id="main">
            <p class="display-4">Welcome to the new profile page!</p>
            <p class="text-info text-center">
                We haven't finished our new profile pages yet :( <br>
                We have a few things we need to finish
            </p>
            {% for post in post_list %}
            <div class="card {% if forloop.last %}mb-4{% else %}mb-2{% endif %}">
                <div class="card-body p-3">
                    <div class="row">
                        <div class="col-12">
                            <div class="row mb-3">
                                <div class="col-6">
                                    <strong class="text-muted">
                                        <small class="text-muted">{{ post.created_at }}</small>
                                    </strong>
                                </div>
                                <div class="col-6 text-right">
                                    <small class="text-muted">
                                        From topic:
                                        <a href="{% host_url 'topic_posts' post.topic.board.pk post.topic.pk host 'www' %}">
                                            {{ post.topic.subject }}
                                        </a>
                                        in board:
                                        <a href="{% host_url 'board_topics' post.topic.board.pk host 'www'  %}">
                                            {{ post.topic.board.name }}
                                        </a>
                                    </small>
                                </div>
                            </div>
                            {{ post.get_message_as_markdown }}
                            {% if post.created_by == user or user.is_superuser %}
                            <div class="mt-3">
                                <a href="{% host_url 'edit_post' post.topic.board.pk post.topic.pk post.pk host 'www' %}"
                                   class="btn btn-primary btn-sm"
                                   role="button">Edit</a>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
    </div>
    </div>
{% endblock %}
